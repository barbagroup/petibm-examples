
*** SLURM JOB SCRIPT ***
#!/usr/bin/env bash

#SBATCH --job-name="sphRe350"
#SBATCH --output=slurm-%j.out
#SBATCH --error=slurm-%j.err
#SBATCH --partition=small-gpu
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=20
#SBATCH --time=24:00:00

module load singularity/3.4.2
module load openmpi/gcc/64/3.1.4

printf "\n*** SLURM JOB SCRIPT ***\n"
cat pegasus.slurm

printf "\n*** PRESENT WORKING DIRECTORY  ***\n"
pwd

printf "\n*** NVIDIA-SMI ***\n"
export CUDA_VISIBLE_DEVICES=0,1
nvidia-smi

simudir="/lustre/groups/barbalab/Re350-2"
indir="/mnt"
image="/SEAS/home/mesnardo/images/petibm-0.4.2_xenial.sif"

mpirun singularity exec \
	--bind $simudir:$indir \
	--nv $image petibm-decoupledibpm \
	-directory $indir \
	-options_left \
	-log_view ascii:$indir/view.log

*** PRESENT WORKING DIRECTORY  ***
/lustre/groups/barbalab/Re350-2

*** NVIDIA-SMI ***
Wed Nov  6 16:08:52 2019       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 418.87.00    Driver Version: 418.87.00    CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla V100-PCIE...  Off  | 00000000:3B:00.0 Off |                    0 |
| N/A   25C    P0    34W / 250W |      0MiB / 16130MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla V100-PCIE...  Off  | 00000000:D8:00.0 Off |                    0 |
| N/A   26C    P0    34W / 250W |      0MiB / 16130MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
AMGX version 2.1.0.131-opensource
Built on Oct 18 2019, 00:32:49
Compiled with CUDA Runtime 10.1, using CUDA driver 10.1
Cannot read file as JSON object, trying as AMGX config
Cannot read file as JSON object, trying as AMGX config
Converting config string to current config version
Parsing configuration string: exception_handling=1 ; 
Using Normal MPI (Hostbuffer) communicator...
Cannot read file as JSON object, trying as AMGX config
Cannot read file as JSON object, trying as AMGX config
Converting config string to current config version
Parsing configuration string: exception_handling=1 ; 
Using Normal MPI (Hostbuffer) communicator...
[time step 0] Writing solution data... done
Completed initialization stage
[time step 2500] Writing solution data... done
[time step 5000] Writing solution data... done
[time step 5000] Writing restart data... done
[time step 7500] Writing solution data... done
[time step 10000] Writing solution data... done
[time step 10000] Writing restart data... done
[time step 12500] Writing solution data... done
[time step 15000] Writing solution data... done
[time step 15000] Writing restart data... done
[time step 17500] Writing solution data... done
[time step 20000] Writing solution data... done
[time step 20000] Writing restart data... done
[time step 22500] Writing solution data... done
[time step 25000] Writing solution data... done
[time step 25000] Writing restart data... done
[time step 27500] Writing solution data... done
[time step 30000] Writing solution data... done
[time step 30000] Writing restart data... done
[time step 32500] Writing solution data... done
[time step 35000] Writing solution data... done
[time step 35000] Writing restart data... done
[time step 37500] Writing solution data... done
[time step 40000] Writing solution data... done
[time step 40000] Writing restart data... done
[time step 42500] Writing solution data... done
[time step 45000] Writing solution data... done
[time step 45000] Writing restart data... done
[time step 47500] Writing solution data... done
[time step 50000] Writing solution data... done
[time step 50000] Writing restart data... done
#PETSc Option Table entries:
-directory /mnt
-log_view ascii:/mnt/view.log
-options_left
-velocity_ksp_atol 1e-6
-velocity_ksp_max_it 1000
-velocity_ksp_rtol 0.0
-velocity_ksp_type bcgs
-velocity_pc_jacobi_type diagonal
-velocity_pc_type jacobi
#End of PETSc Option Table entries
There are no unused options.
